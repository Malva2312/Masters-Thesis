# filepath: /nas-ctm01/homes/jmalva/Masters-Thesis/config_files/model/pytorch_lightning_model/luna25_pytorch_lightning_effnet_svm.yaml
model_id: ${..model_id}
model_name: ${..model_name}
hyperparameters:
  device: cuda

  optimiser:
    type: Adam #Maybe also try AdamW
    kwargs:
      lr: 0.00001
      #weight_decay: 0.0001 #does this help?

  number_of_classes: 2
  
  # EfficientNet parameters
  effnet_config:
    architecture: b0
    criterion:
      apply_weights: True
      device: ${...device}
      metadataframe: ${......data.metadataframe}
    optimiser: ${..optimiser}
    extractors:
        - name: lbp
        - name: shape
        - name: fof

  # SVM parameters
  svm_config:
    criterion: hinge
    optimiser: ${..optimiser}
    extractors:
      - lbp

  # ResNet parameters
  resnet_config:
    architecture: 18         # Options: 18, 34, 50, 101, 152, etc.
    default_layer: layer3  # Options: layer1, layer2, layer3, layer4
    criterion:
      apply_weights: True
      device: ${...device}
      metadataframe: ${......data.metadataframe}
    optimiser: ${..optimiser}
    

  fused_resnet_config:
    architecture: 18         # Options: 18, 34, 50, 101, 152, etc.
    default_layer: layer3  # Options: layer1, layer2, layer3, layer4
    criterion:
      apply_weights: True
      device: ${...device}
      metadataframe: ${......data.metadataframe}
    optimiser: ${..optimiser}
    extractors:
      - name: lbp
        layer: layer1
      - name: shape
        layer: layer2
      - name: fof
        layer: layer1

  base_resnet_config:
    architecture: 18         # Options: 18, 34, 50, 101, 152, etc.
    default_layer: layer3  # Options: layer1, layer2, layer3, layer4
    criterion:
      apply_weights: True
      device: ${...device}
      metadataframe: ${......data.metadataframe}
    optimiser: ${..optimiser}
  
  convnext_config:
    architecture: tiny
    criterion:
      apply_weights: True
      device: ${...device}
      metadataframe: ${......data.metadataframe}
    optimiser: ${..optimiser}
    #extractors:
    #    - name: lbp
    #    - name: shape
    #    - name: fof
